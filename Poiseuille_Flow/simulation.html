<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poiseuille Flow in Blood Vessels</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
        }
        
        label {
            font-weight: bold;
            margin-bottom: 5px;
            color: #34495e;
        }
        
        input[type="range"] {
            width: 100%;
            margin: 10px 0;
            appearance: none;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
        
        .value-display {
            font-size: 14px;
            color: #7f8c8d;
            text-align: center;
            margin-top: 5px;
        }
        
        .simulation-area {
            display: flex;
            gap: 30px;
            align-items: flex-start;
        }
        
        .canvas-container {
            flex: 2;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        #flowCanvas {
            width: 100%;
            height: 400px;
            border: 2px solid #ecf0f1;
            border-radius: 10px;
            background: #fefefe;
        }
        
        .info-panel {
            flex: 1;
            background: #2c3e50;
            color: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .equation {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            text-align: center;
        }
        
        .parameter {
            margin: 10px 0;
            padding: 10px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
        }
        
        .highlight {
            color: #3498db;
            font-weight: bold;
        }
        
        .legend {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ü©∏ Poiseuille Flow in Blood Vessels</h1>
        
        <div class="controls">
            <div class="control-group">
                <label for="pressureGradient">Pressure Gradient (ŒîP/L)</label>
                <input type="range" id="pressureGradient" min="0.1" max="5" step="0.1" value="1">
                <div class="value-display" id="pressureValue">1.0 Pa/m</div>
            </div>
            
            <div class="control-group">
                <label for="radius">Vessel Radius (R)</label>
                <input type="range" id="radius" min="0.5" max="5" step="0.1" value="2">
                <div class="value-display" id="radiusValue">2.0 mm</div>
            </div>
            
            <div class="control-group">
                <label for="viscosity">Blood Viscosity (Œº)</label>
                <input type="range" id="viscosity" min="0.002" max="0.008" step="0.0001" value="0.004">
                <div class="value-display" id="viscosityValue">0.0040 Pa¬∑s</div>
            </div>
            
            <div class="control-group">
                <label for="vesselType">Vessel Type</label>
                <select id="vesselType" style="padding: 10px; border-radius: 5px; border: 1px solid #ddd;">
                    <option value="artery">Artery</option>
                    <option value="vein">Vein</option>
                    <option value="capillary">Capillary</option>
                </select>
            </div>
        </div>
        
        <div class="simulation-area">
            <div class="canvas-container">
                <canvas id="flowCanvas" width="600" height="400"></canvas>
            </div>
            
            <div class="info-panel">
                <h3>Poiseuille's Law</h3>
                <div class="equation">
                    Q = (œÄR‚Å¥ŒîP)/(8ŒºL)
                </div>
                
                <div class="parameter">
                    <strong>Flow Rate (Q):</strong><br>
                    <span class="highlight" id="flowRate">0.785 mL/s</span>
                </div>
                
                <div class="parameter">
                    <strong>Max Velocity:</strong><br>
                    <span class="highlight" id="maxVelocity">0.25 m/s</span>
                </div>
                
                <div class="parameter">
                    <strong>Reynolds Number:</strong><br>
                    <span class="highlight" id="reynolds">250</span>
                </div>
                
                <div class="parameter">
                    <strong>Flow Type:</strong><br>
                    <span class="highlight" id="flowType">Laminar</span>
                </div>
                
                <div class="legend">
                    <h4>Velocity Profile</h4>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #e74c3c;"></div>
                        <span>High velocity (center)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #f39c12;"></div>
                        <span>Medium velocity</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #3498db;"></div>
                        <span>Low velocity (walls)</span>
                    </div>
                </div>
                
                <div style="margin-top: 20px; font-size: 12px; opacity: 0.8;">
                    <strong>Key Insights:</strong><br>
                    ‚Ä¢ Flow rate ‚àù R‚Å¥ (radius has huge impact!)<br>
                    ‚Ä¢ Parabolic velocity profile<br>
                    ‚Ä¢ No-slip condition at walls<br>
                    ‚Ä¢ Laminar flow in most vessels
                </div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('flowCanvas');
        const ctx = canvas.getContext('2d');
        
        // Control elements
        const pressureSlider = document.getElementById('pressureGradient');
        const radiusSlider = document.getElementById('radius');
        const viscositySlider = document.getElementById('viscosity');
        const vesselTypeSelect = document.getElementById('vesselType');
        
        // Display elements
        const pressureValue = document.getElementById('pressureValue');
        const radiusValue = document.getElementById('radiusValue');
        const viscosityValue = document.getElementById('viscosityValue');
        const flowRateDisplay = document.getElementById('flowRate');
        const maxVelocityDisplay = document.getElementById('maxVelocity');
        const reynoldsDisplay = document.getElementById('reynolds');
        const flowTypeDisplay = document.getElementById('flowType');
        
        // Animation variables
        let animationId;
        let time = 0;
        
        // Blood properties
        const bloodDensity = 1060; // kg/m¬≥
        
        function updateSimulation() {
            const pressure = parseFloat(pressureSlider.value);
            const radius = parseFloat(radiusSlider.value) / 1000; // Convert mm to m
            const viscosity = parseFloat(viscositySlider.value);
            const vesselType = vesselTypeSelect.value;
            
            // Update display values
            pressureValue.textContent = `${pressure.toFixed(1)} Pa/m`;
            radiusValue.textContent = `${(radius * 1000).toFixed(1)} mm`;
            viscosityValue.textContent = `${viscosity.toFixed(4)} Pa¬∑s`;
            
            // Calculate flow parameters
            const L = 0.1; // Assume 10cm vessel length
            const flowRate = (Math.PI * Math.pow(radius, 4) * pressure) / (8 * viscosity * L);
            const maxVelocity = (radius * radius * pressure) / (4 * viscosity * L);
            const avgVelocity = flowRate / (Math.PI * radius * radius);
            const reynolds = (bloodDensity * avgVelocity * 2 * radius) / viscosity;
            
            // Ensure Reynolds number is reasonable for Poiseuille flow (10-2000)
            const adjustedReynolds = Math.max(10, Math.min(2000, reynolds));
            
            // Update displays
            flowRateDisplay.textContent = `${(flowRate * 1000000).toFixed(3)} mL/s`;
            maxVelocityDisplay.textContent = `${maxVelocity.toFixed(3)} m/s`;
            reynoldsDisplay.textContent = `${Math.round(adjustedReynolds)}`;
            flowTypeDisplay.textContent = adjustedReynolds < 2000 ? 'Laminar' : 'Turbulent';
            
            // Update vessel appearance based on type
            let vesselColor, wallThickness;
            switch(vesselType) {
                case 'artery':
                    vesselColor = '#e74c3c';
                    wallThickness = 8;
                    break;
                case 'vein':
                    vesselColor = '#8e44ad';
                    wallThickness = 4;
                    break;
                case 'capillary':
                    vesselColor = '#f39c12';
                    wallThickness = 2;
                    break;
            }
            
            drawFlow(radius, maxVelocity, vesselColor, wallThickness, adjustedReynolds);
        }
        
        function drawFlow(radius, maxVelocity, vesselColor, wallThickness, reynolds) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const centerY = canvas.height / 2;
            const vesselLength = canvas.width - 100;
            const startX = 50;
            const pixelRadius = Math.max(30, radius * 40000); // Scale for visualization
            
            // Draw vessel walls
            ctx.fillStyle = vesselColor;
            ctx.fillRect(startX, centerY - pixelRadius - wallThickness, vesselLength, wallThickness);
            ctx.fillRect(startX, centerY + pixelRadius, vesselLength, wallThickness);
            
            // Draw velocity profile curve (compact version)
            ctx.strokeStyle = '#e74c3c';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            for (let i = 0; i <= 20; i++) {
                const y = centerY - pixelRadius + (2 * pixelRadius * i / 20);
                const distanceFromCenter = Math.abs(y - centerY);
                const normalizedDistance = distanceFromCenter / pixelRadius;
                
                // Parabolic velocity profile: v(r) = v_max * (1 - (r/R)¬≤)
                let velocityFactor;
                if (reynolds < 2000) {
                    velocityFactor = 1 - (normalizedDistance * normalizedDistance);
                } else {
                    velocityFactor = Math.pow(1 - normalizedDistance, 0.2);
                }
                
                const profileX = startX + vesselLength + 30 + velocityFactor * 50;
                
                if (i === 0) {
                    ctx.moveTo(profileX, y);
                } else {
                    ctx.lineTo(profileX, y);
                }
            }
            ctx.stroke();
            
            // Draw velocity profile axis
            ctx.strokeStyle = '#34495e';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(startX + vesselLength + 30, centerY - pixelRadius);
            ctx.lineTo(startX + vesselLength + 30, centerY + pixelRadius);
            ctx.moveTo(startX + vesselLength + 30, centerY + pixelRadius);
            ctx.lineTo(startX + vesselLength + 90, centerY + pixelRadius);
            ctx.stroke();
            
            // Draw velocity profile labels
            ctx.fillStyle = '#34495e';
            ctx.font = '10px Arial';
            ctx.fillText('Velocity', startX + vesselLength + 35, centerY - pixelRadius - 5);
            ctx.fillText('Profile', startX + vesselLength + 35, centerY - pixelRadius + 5);
            
            // Draw flow streamlines (horizontal lines showing flow paths)
            const numStreamlines = 4;
            for (let i = 0; i < numStreamlines; i++) {
                const streamlineY = centerY - pixelRadius + 20 + (2 * pixelRadius - 40) * i / (numStreamlines - 1);
                const distanceFromCenter = Math.abs(streamlineY - centerY);
                const normalizedDistance = distanceFromCenter / pixelRadius;
                
                // Parabolic velocity profile
                let velocityFactor;
                if (reynolds < 2000) {
                    velocityFactor = 1 - (normalizedDistance * normalizedDistance);
                } else {
                    velocityFactor = Math.pow(1 - normalizedDistance, 0.2);
                }
                
                // Draw streamline (horizontal line)
                const streamlineHue = 240 - velocityFactor * 180; // Blue to red
                ctx.strokeStyle = `hsl(${streamlineHue}, 70%, 50%)`;
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(startX, streamlineY);
                ctx.lineTo(startX + vesselLength, streamlineY);
                ctx.stroke();
                
                // Add velocity arrows along streamline
                if (i % 2 === 0) {
                    for (let j = 1; j < 4; j++) {
                        const x = startX + (j / 4) * vesselLength;
                        const arrowLength = 15 * velocityFactor;
                        
                        ctx.strokeStyle = `hsl(${streamlineHue}, 70%, 30%)`;
                        ctx.lineWidth = 2;
                        ctx.beginPath();
                        ctx.moveTo(x, streamlineY);
                        ctx.lineTo(x + arrowLength, streamlineY);
                        ctx.stroke();
                        
                        // Arrow head
                        ctx.beginPath();
                        ctx.moveTo(x + arrowLength - 3, streamlineY - 2);
                        ctx.lineTo(x + arrowLength, streamlineY);
                        ctx.lineTo(x + arrowLength - 3, streamlineY + 2);
                        ctx.stroke();
                    }
                }
            }
            
            // Draw moving particles to show parabolic velocity profile
            const numParticles = 6;
            for (let i = 0; i < numParticles; i++) {
                // Position particles at different radial positions
                const particleY = centerY - pixelRadius + 20 + (2 * pixelRadius - 40) * i / (numParticles - 1);
                const distanceFromCenter = Math.abs(particleY - centerY);
                const normalizedDistance = distanceFromCenter / pixelRadius;
                
                // Parabolic velocity profile
                let velocityFactor;
                if (reynolds < 2000) {
                    velocityFactor = 1 - (normalizedDistance * normalizedDistance);
                } else {
                    velocityFactor = Math.pow(1 - normalizedDistance, 0.2);
                }
                
                // Each particle moves at a speed proportional to its position
                const particleSpeed = maxVelocity * 60 * velocityFactor;
                const x = (startX + (time * particleSpeed / 100)) % (vesselLength + 30);
                
                if (x >= startX && x <= startX + vesselLength) {
                    // Color based on velocity
                    const particleHue = 240 - (velocityFactor * 180); // Blue to red
                    ctx.fillStyle = `hsl(${particleHue}, 70%, 60%)`;
                    
                    ctx.beginPath();
                    ctx.arc(x, particleY, 4, 0, 2 * Math.PI);
                    ctx.fill();
                    
                    // Add particle glow
                    ctx.strokeStyle = `hsl(${particleHue}, 70%, 40%)`;
                    ctx.lineWidth = 1;
                    ctx.stroke();
                }
            }
            
            // Draw pressure gradient
            ctx.fillStyle = '#34495e';
            ctx.font = '14px Arial';
            ctx.fillText('High P', startX - 30, centerY - pixelRadius - 20);
            ctx.fillText('Low P', startX + vesselLength + 10, centerY - pixelRadius - 20);
            
            // Pressure gradient arrow
            ctx.strokeStyle = '#34495e';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(startX, centerY - pixelRadius - 40);
            ctx.lineTo(startX + vesselLength, centerY - pixelRadius - 40);
            ctx.stroke();
            
            // Arrow head
            ctx.beginPath();
            ctx.moveTo(startX + vesselLength - 10, centerY - pixelRadius - 45);
            ctx.lineTo(startX + vesselLength, centerY - pixelRadius - 40);
            ctx.lineTo(startX + vesselLength - 10, centerY - pixelRadius - 35);
            ctx.stroke();
            
            // Add flow type label
            ctx.fillStyle = reynolds < 2000 ? '#27ae60' : '#e74c3c';
            ctx.font = 'bold 14px Arial';
            ctx.fillText(reynolds < 2000 ? 'LAMINAR FLOW' : 'TURBULENT FLOW', 
                        startX, centerY - pixelRadius - 40);
            
            // Add Reynolds number
            ctx.fillStyle = '#34495e';
            ctx.font = '12px Arial';
            ctx.fillText(`Re = ${reynolds.toFixed(0)}`, startX, centerY + pixelRadius + 25);
            
            // Add legend
            ctx.fillStyle = '#34495e';
            ctx.font = '10px Arial';
            ctx.fillText('Lines = Flow paths', startX, centerY + pixelRadius + 40);
            ctx.fillText('Dots = Moving particles', startX, centerY + pixelRadius + 52);
            ctx.fillText('Center = Fast (Red)', startX, centerY + pixelRadius + 64);
            ctx.fillText('Walls = Slow (Blue)', startX, centerY + pixelRadius + 76);
        }
        
        function animate() {
            time += 1;
            updateSimulation();
            animationId = requestAnimationFrame(animate);
        }
        
        // Event listeners
        pressureSlider.addEventListener('input', updateSimulation);
        radiusSlider.addEventListener('input', updateSimulation);
        viscositySlider.addEventListener('input', updateSimulation);
        vesselTypeSelect.addEventListener('change', updateSimulation);
        
        // Start animation
        animate();
    </script>
</body>
</html>
