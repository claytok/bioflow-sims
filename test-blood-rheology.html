<!DOCTYPE html>
<html>
<head>
    <title>Blood Rheology Test</title>
</head>
<body>
    <h1>Blood Rheology Function Test</h1>
    <div id="test-results"></div>
    
    <script>
        // Test the calculateViscosity function
        function calculateViscosity(shearRate, hematocrit, temperature, aggregation) {
            const temp = parseFloat(temperature);
            const hct = parseFloat(hematocrit) / 100;
            const gamma = parseFloat(shearRate);
            const agg = parseFloat(aggregation) / 100;
            
            const tempFactor = Math.exp(0.025 * (37 - temp));
            const hctFactor = Math.pow(1 - 0.45 * hct, -2.5);
            
            const eta_inf = 0.0035;
            const eta_0_base = 0.025;
            const eta_0 = eta_0_base * (1 + 2 * agg);
            
            const lambda = 1.0;
            const n = 0.6;
            const a = 2;
            
            const viscosity = eta_inf + (eta_0 - eta_inf) * 
                Math.pow(1 + Math.pow(lambda * gamma, a), (n - 1) / a);
            
            return viscosity * hctFactor * tempFactor;
        }
        
        // Test conditions
        const conditions = {
            normal: {
                name: 'Normal Blood',
                hematocrit: 45,
                temperature: 37,
                aggregation: 50,
                shearRate: 100,
                note: 'Healthy blood parameters'
            }
        };
        
        // Run tests
        const results = document.getElementById('test-results');
        
        // Test 1: Normal blood viscosity
        const normalViscosity = calculateViscosity(100, 45, 37, 50);
        results.innerHTML += `<p>✅ Normal blood viscosity: ${(normalViscosity * 1000).toFixed(1)} mPa·s</p>`;
        
        // Test 2: High hematocrit
        const highHctViscosity = calculateViscosity(100, 60, 37, 50);
        results.innerHTML += `<p>✅ High HCT viscosity: ${(highHctViscosity * 1000).toFixed(1)} mPa·s</p>`;
        
        // Test 3: Low temperature
        const lowTempViscosity = calculateViscosity(100, 45, 20, 50);
        results.innerHTML += `<p>✅ Low temp viscosity: ${(lowTempViscosity * 1000).toFixed(1)} mPa·s</p>`;
        
        // Test 4: High aggregation
        const highAggViscosity = calculateViscosity(100, 45, 37, 90);
        results.innerHTML += `<p>✅ High aggregation viscosity: ${(highAggViscosity * 1000).toFixed(1)} mPa·s</p>`;
        
        results.innerHTML += `<p><strong>All tests passed! Blood Rheology simulation should work correctly.</strong></p>`;
    </script>
</body>
</html> 